# 智能笔记本产品需求文档 (PRD)

## 1. 产品概述

### 1.1 产品定位
托福学习App的智能笔记本模块，作为整体学习平台的第一期功能。未来将与题库、做题记录等模块集成，通过AI Agent实现个性化学习体验。

### 1.2 产品目标
- 提供高效的笔记管理和编辑体验
- 支持结构化的学习内容组织
- 预留AI集成接口，为后续智能化功能奠定基础

## 2. 功能需求

### 2.1 核心功能
- 在线笔记编辑器
- 二级文件结构管理
- 基础表格功能
- 用户身份管理

### 2.2 文件结构管理

#### 2.2.1 文件夹层级
**第一级：文件夹**
- 系统文件夹（不可删除/重命名）：
  - 单词表
  - 例句集
  - 素材库
- 用户自建文件夹：
  - 支持创建、重命名、删除操作
  - 无数量限制

**第二级：笔记文档**
- 支持创建、删除、编辑操作
- 不支持创建子文件夹
- 以TipTap JSON格式存储内容

#### 2.2.2 文件夹操作权限
| 操作类型 | 系统文件夹 | 用户文件夹 |
|---------|-----------|-----------|
| 创建     | ❌        | ✅        |
| 重命名   | ❌        | ✅        |
| 删除     | ❌        | ✅        |
| 查看     | ✅        | ✅        |

### 2.3 笔记编辑功能

#### 2.3.1 基础编辑
- 富文本编辑（基于TipTap）
- 支持常用格式：加粗、斜体、下划线、标题等
- 自动保存功能

#### 2.3.2 表格功能
- 创建基础表格
- 添加/删除行和列
- 调整列宽
- 表格内文本编辑

### 2.4 用户管理
- 简化认证：用户名输入即可使用
- 用户数据隔离
- 预计支持100万用户规模

## 3. 技术架构

### 3.1 技术栈选型
- **前端框架**：React 19
- **编辑器**：TipTap (富文本编辑器)
- **UI框架**：Material-UI (Material Design风格)
- **后端框架**：Node.js + Express
- **数据库**：MongoDB (云服务)
- **部署方案**：本地开发 → 阿里云函数计算

### 3.2 架构设计

#### 3.2.1 前端架构
```
├── 左侧面板 (文件树)
│   ├── 系统文件夹 (只读)
│   └── 用户文件夹 (可操作)
└── 右侧面板 (编辑区域)
    ├── 笔记编辑器 (TipTap)
    └── 工具栏 (格式化、表格等)
```

#### 3.2.2 数据存储结构
```json
{
  "user": "用户名",
  "folders": [
    {
      "id": "folder_id",
      "name": "文件夹名",
      "type": "system|user",
      "notes": [
        {
          "id": "note_id", 
          "title": "笔记标题",
          "content": "TipTap JSON格式内容",
          "created_at": "创建时间",
          "updated_at": "更新时间"
        }
      ]
    }
  ]
}
```

### 3.3 API接口设计

#### 3.3.1 文件夹管理
- `GET /api/folders` - 获取文件夹列表
- `POST /api/folders` - 创建文件夹
- `PUT /api/folders/:id` - 更新文件夹
- `DELETE /api/folders/:id` - 删除文件夹

#### 3.3.2 笔记管理
- `GET /api/folders/:folderId/notes` - 获取笔记列表
- `GET /api/notes/:id` - 获取笔记内容
- `POST /api/folders/:folderId/notes` - 创建笔记
- `PUT /api/notes/:id` - 更新笔记
- `DELETE /api/notes/:id` - 删除笔记

#### 3.3.3 用户管理
- `POST /api/auth/login` - 用户登录
- `GET /api/user/profile` - 获取用户信息

#### 3.3.4 AI集成接口 (预留)
- `POST /api/ai/suggest` - AI内容建议
- `POST /api/ai/enhance` - AI内容优化

## 4. 非功能性需求

### 4.1 性能要求
- 页面加载时间 < 2秒
- 笔记保存响应时间 < 1秒
- 支持100万用户并发访问

### 4.2 兼容性
- 支持现代浏览器 (Chrome 90+, Firefox 88+, Safari 14+)
- 响应式设计，适配桌面端

### 4.3 安全性
- 用户数据隔离
- 输入数据验证和清理
- XSS和CSRF防护

## 5. 开发计划

### 5.1 第一期 (MVP版本)
- ✅ 基础项目搭建
- ✅ 用户认证系统
- ✅ 文件夹结构管理
- ✅ 基础笔记CRUD
- ✅ TipTap编辑器集成

### 5.2 第二期 (功能完善)
- ✅ 表格功能实现
- ✅ UI优化和交互体验
- ✅ 性能优化

### 5.3 第三期 (AI集成准备)
- ✅ AI接口预留和测试
- ✅ 部署上线
- ✅ 用户测试和反馈收集

## 6. 风险评估

### 6.1 技术风险
- MongoDB云服务稳定性
- 阿里云函数计算的性能表现
- TipTap编辑器的复杂度

### 6.2 业务风险
- 用户规模增长超预期
- AI集成的技术难度

### 6.3 缓解措施
- 数据库备份策略
- 性能监控和预警
- 分阶段发布和灰度测试